# 🔑 百炼大模型完整配置指南

## 📋 基于官方控制台的配置步骤

根据[百炼大模型控制台](https://bailian.console.aliyun.com/?spm=a2c4g.11186623.aillm.3.4f934e7aN2boLD&tab=api&scm=20140722.S_%E6%88%91%E7%9A%84%E7%99%BE%E7%82%BC%E5%A4%A7%E6%A8%A1%E5%9E%8BAPI%E5%AF%86%E9%92%A5%E5%9C%A8%E5%93%AA%E9%87%8C._.RL_%E6%88%91%E7%9A%84%E7%99%BE%E7%82%BC%E5%A4%A7%E6%A8%A1%E5%9E%8BAPI%E5%AF%86%E9%92%A5%E5%9C%A8%E5%93%AA%E9%87%8C-LOC_aillm-OR_chat-V_3-RC_llm#/api)的官方信息，以下是完整的配置步骤：

### 第一步：开通百炼大模型服务

1. **访问百炼大模型控制台**
   - 打开 [百炼大模型控制台](https://bailian.console.aliyun.com/)
   - 使用阿里云主账号登录

2. **开通服务**
   - 如果是首次使用，需要先开通百炼大模型服务
   - 确认账户有足够的余额
   - 阅读并同意服务条款

### 第二步：创建API密钥

1. **进入API管理页面**
   - 在控制台左侧导航栏找到"API管理"
   - 点击"API密钥管理"

2. **创建新的API密钥**
   - 点击"创建API密钥"
   - 填写密钥名称（如：word-story-generator）
   - 选择密钥类型（建议选择"API Key"）
   - 设置密钥权限和有效期

3. **复制API密钥**
   - 创建成功后，立即复制生成的API密钥
   - **重要**：密钥以 `sk-` 开头，请完整复制
   - 密钥格式：`sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx`

### 第三步：验证API密钥权限

1. **检查密钥状态**
   - 在API密钥管理页面查看密钥状态
   - 确认密钥为"启用"状态
   - 检查密钥的权限设置

2. **确认服务权限**
   - 检查账户是否有百炼大模型的调用权限
   - 确认服务已开通且余额充足

### 第四步：在应用中配置

1. **打开应用设置**
   - 在应用中点击"设置"
   - 或直接访问 `/settings` 路径

2. **填写配置信息**
   - **API密钥**：粘贴刚才复制的API密钥
   - **端点地址**：`https://bailian.aliyuncs.com/v2/api/invoke`（自动设置）
   - **模型选择**：`bailian-v1 (百炼大模型)`

3. **测试连接**
   - 点击"测试连接"按钮
   - 如果显示"连接测试成功"，说明配置正确

### 第五步：验证配置

使用提供的测试脚本验证配置：

```bash
# 运行测试脚本
node test-api.js
```

## 🔧 正确的API配置

### 端点地址
- **百炼大模型**：`https://bailian.aliyuncs.com/v2/api/invoke`
- **通义千问**：`https://dashscope.aliyuncs.com/api/v1/services/aigc/text-generation/generation`

### 请求格式
```json
{
  "model": "bailian-v1",
  "prompt": "你的问题或提示",
  "temperature": 0.7,
  "top_p": 0.8,
  "max_tokens": 2000
}
```

### 响应格式
```json
{
  "Success": true,
  "Data": {
    "text": "生成的文本内容"
  }
}
```

## 🚨 常见问题解决

### 问题1：API令牌认证失败 (Code: 100016)

**可能原因：**
- API密钥无效或已过期
- 账户没有百炼大模型访问权限
- 服务未开通或余额不足

**解决方案：**
1. 重新生成API密钥
2. 检查账户权限和余额
3. 联系阿里云客服确认服务状态

### 问题2：端点地址错误

**解决方案：**
- 确保使用正确的端点：`https://bailian.aliyuncs.com/v2/api/invoke`
- 不要使用通义千问的端点地址

### 问题3：请求格式错误

**解决方案：**
- 使用 `prompt` 字段而不是 `input.messages`
- 确保模型名称为 `bailian-v1`

## 📞 技术支持

如果遇到配置问题：

1. **查看官方文档**：[百炼大模型API文档](https://help.aliyun.com/zh/bailian/)
2. **联系阿里云客服**：通过控制台提交工单
3. **检查服务状态**：查看阿里云服务状态页面

## ✅ 配置检查清单

- [ ] 百炼大模型服务已开通
- [ ] 账户余额充足
- [ ] API密钥已创建且有效
- [ ] 密钥权限设置正确
- [ ] 端点地址正确
- [ ] 模型选择正确
- [ ] 连接测试成功
- [ ] 故事生成功能正常

---

**注意**：本指南基于官方控制台信息，如有更新请参考最新官方文档。 